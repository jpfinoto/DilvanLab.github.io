<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>7.&nbsp;Foliotracker</title><link rel="stylesheet" href="../../html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.74.3"><link rel="home" href="index.html" title="Object Oriented Computing"><link rel="up" href="group_assignments.html" title="Chapter&nbsp;22.&nbsp;Group Assignments"><link rel="prev" href="group_assignments_pacman.html" title="6.&nbsp;PacMan"><link rel="next" href="gui_awt.html" title="Chapter&nbsp;23.&nbsp;Extra: Graphic User Interface - AWT"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.&nbsp;Foliotracker</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="group_assignments_pacman.html"><img src="../../images/prev.gif" alt="Prev"></a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;22.&nbsp;Group Assignments</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="gui_awt.html"><img src="../../images/next.gif" alt="Next"></a></td></tr></table><hr></div><div class="breadcrumbs"><a href="/moodle/course/view.php?id=4">OOC</a> &gt;
     <span class="breadcrumb-link"><a href="index.html">Object Oriented Computing</a></span> &gt; <span class="breadcrumb-link"><a href="group_assignments.html">Group Assignments</a></span> &gt; <span class="breadcrumb-node">Foliotracker</span></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="group_assignments_foliotracker"></a>7.&nbsp;Foliotracker</h2></div></div></div><p>Foliotracker is an application program for tracking the value of a
      stock portfolio.</p><p>In the first of two parts, you'll decide on the basic
      functionality of your program, design a graphical user interface (GUI)
      for it, and specify an application programmer's interface (API) through
      which the GUI will access the components of the code that obtain stock
      quotes, maintain a database of values, and so on.</p><p>The benefit of decoupling this application into two parts (a
      front-end GUI and the back-end implementation) by creating a
      well-defined API is to allow for different types of front-end clients to
      access your system and use its functionality. You won't actually write
      any of the code that implements the API; instead you'll write a stub: a
      piece of code that can be used to test a client of the API, but which
      provides only very limited functionality. You may, for example, have the
      stub compute nothing and just look up values in a fixed table. This stub
      will allow you to assemble and test the GUI, and make sure that the
      functionality seems reasonable. In the second part, you'll implement the
      functionality of the API itself. You should not need to make any changes
      to the GUI or to the API.</p><p>The focus of the first part is the designing of the API and GUI
      implementation. You'll need to learn how to use Swing. The online Java&#8482;
      Tutorial trail, which is at <a class="ulink" href="http://java.sun.com/docs/books/tutorial/" target="_top">http://java.sun.com/docs/books/tutorial/</a>
      , includes a section on Swing and the Java Foundation Classes; you'll
      find it at <a class="ulink" href="http://java.sun.com/docs/books/tutorial/uiswing/" target="_top">http://java.sun.com/docs/books/tutorial/uiswing/</a>
      . The focus of the second part is the designing of the backend and its
      implementation. You shouldn't need to learn anything new, but will have
      an opportunity to refine your skills in designing with abstract data
      types, object models, etc. You don't need to implement the code for
      obtaining the stock quotes; we provide a class for you that has a simple
      method that takes a ticker symbol as a string and returns a
      price.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10392"></a>7.1.&nbsp;Part 1: API and GUI</h3></div></div></div><p>Foliotracker enables the user to track the contents and value of
        multiple stock portfolios. A Foliotracker can be used to manage and
        maintain multiple stock portfolios where a portfolio is a collection
        of stock holdings. A portfolio could also contain meta-data about a
        person's transaction history, statistics, etc. Foliotracker discovers
        current stock values by querying a stock quote server across the World
        Wide Web. Your first task is to determine what functionality
        Foliotracker should support. At the minimum, it should be possible
        to:</p><div class="itemizedlist"><ul type="disc"><li><p>create multiple portfolios;</p></li><li><p>see the positions (stock name, number of shares held, price
            per share, and value of the holding) in a portfolio;</p></li><li><p>increase and decrease the number of shares of a
            stock;</p></li><li><p>see the total value of a portfolio.</p></li></ul></div><p>We have provided some screenshots of possible functionality. An
        example of a Foliotracker with multiple stock portfolios open. The
        user can:</p><div class="itemizedlist"><ul type="disc"><li><p>Add a new stock to his/her portfolio.</p></li><li><p>Switch to another portfolio using the tab control.</p></li><li><p>Double-click on a stock for editing purposes.</p></li><li><p>Close the current portfolio.</p></li><li><p>Delete the current portfolio.</p></li></ul></div><div class="figure"><a name="d0e10428"></a><p class="title"><b>Figure&nbsp;22.1.&nbsp;Foliotracker Window</b></p><div class="figure-contents"><div class="mediaobject"><img src="../xml/img/MultiFolio.jpg" alt="Foliotracker Window"></div></div></div><br class="figure-break"><p>Here are some possible features you might consider including in
        your design:</p><div class="itemizedlist"><ul type="disc"><li><p>saving portfolio information to disk;</p></li><li><p>indicating whether price is going up or down, perhaps by
            coloring the text or using little coloured arrows;</p></li><li><p>allowing the user to enter the price at which a stock was
            bought, to estimate gains and losses;</p></li><li><p>keeping track of highs and lows;</p></li><li><p>setting watches causing an action to occur when the stock
            goes up or down some amount;</p></li><li><p>sorting positions by value, ticker symbol, etc.</p></li></ul></div><p>You should choose a set of features that you plan to implement.
        We recommend that you order them according to difficulty and
        desirability, and think carefully about which you will jettison if
        things turn out harder than you thought.</p><p>More fundamentally, you will need to consider basic questions
        such as</p><div class="itemizedlist"><ul type="disc"><li><p>how portfolios will be identified (with names provided by
            the user?);</p></li><li><p>when stock prices will be updated (periodically? by explicit
            command?);</p></li><li><p>how to handle exceptional cases, such as ticker symbols that
            don't match stocks, or how to behave when the web site is not
            responding;</p></li><li><p>whether multiple portfolios can be shown at once;</p></li><li><p>whether multiple simultaneous views of the same portfolio
            are allowed.</p></li></ul></div><p>These issues need to be addressed at the start; they'll be much
        harder to deal with if you postpone them.</p><p>In the design of the API, you will also need to resolve some
        basic issues. Two important ones are:</p><div class="itemizedlist"><ul type="disc"><li><p>whether the API will be passive, in the sense that the
            application simply treats it as a source of information, or</p></li><li><p>whether it will be active, by having functionality to make
            periodic callbacks, for example; what types will be exposed at the
            interface.</p></li></ul></div><p>Your API specification will be a complete description of the
        functionality of the program, ignoring only the question of how the
        program and user communicate via the GUI. Your GUI should be easy to
        use and attractive, and straightforward to build. You'll probably want
        to play around with Swing a bit to get a feel for how things are done
        and what's possible before you design it.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10488"></a>7.2.&nbsp;Part 2: Implementing the API</h3></div></div></div><p>Your task in this part is to complete your Foliotracker by
        implementing the API which you defined in part 1. You will need to
        design the internal structure of your Foliotracker backend, and test
        the program as a whole. This program is difficult to test because it
        involves a GUI, and because the changing stock prices make it hard to
        do repeatable tests. So you will need to devise a reasonable testing
        strategy that gives you some confidence that the application works
        reliably, and that the stock prices and position and portfolio
        valuations can be trusted. You will probably want to take advantage of
        the programmatic interface you designed in part 1, and test the GUI
        separately in a more ad hoc manner.</p><p>We have provided a QuoteServer module for your convenience. If
        you are curious, you can look at the source code for the QuoteServer,
        but you should be able to make use of it using only the method
        <code class="computeroutput">QuoteServer.getLastValue("&lt;ticker&gt;")</code>.</p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="../../images/caution.png"></td><th align="left">Caution</th></tr><tr><td align="left" valign="top"><p>The <span class="command"><strong>QuoteServer.java</strong></span> program can be
          outdated, test it before begining your project. If it does not work
          try to find a Java progam in the Internet that can read quotes. If
          you have problems contact the teacher.</p></td></tr></table></div><p>File <span class="command"><strong>QuoteServer.java</strong></span>:</p><pre class="programlisting">package folioTracker;

import java.net.*;
import java.io.*;
import java.util.*;

/**
 * QuoteServer is a utility class that allows calling code to 
 * retrieve the latest market value of a given stock by ticker symbol.
 * The QuoteServer obtains the stock value by using the website:
 * &lt;a href="http://quote.fool.com"&gt;&lt;tt&gt;http://quote.fool.com&lt;/tt&gt;&lt;/a&gt; &lt;Br&gt;
 * Examples of ticker symbols are &lt;tt&gt;MSFT&lt;/tt&gt; and &lt;tt&gt;orcl&lt;/tt&gt;.
 * (Note that ticker symbols are not case sensitive.  That is that "MSFT"
 * and "msft" are functionally equivalent.)&lt;p&gt;
 *
 * A valid ticker symbol is one that is currently registered with either
 * the New York Stock Exchange (NYSE) or NASDAQ.
 */

public class QuoteServer {

    protected static final String _URL = "http://quote.fool.com/simple.asp?symbols=";
    protected static final String _TOKEN1 = "mwsimplelast";
    protected static final String _TOKEN2 = "NOBR";
    protected static final String _DELIMITER = "&amp;&lt;&gt;=";    
    public static void main(String[] args) {
        try {
            String str = getLastValue(args[0]);
            System.out.println(args[0] + " has a stock value of " + str);
        } catch(Exception e) { System.err.println(e); }
    }

    /** 
     * 
     * retrieve the latest market value of a stock
     *
     * @requires: tickerSymbol != null
     * @effects: returns a current
     *          value for tickerSymbol as a dollar amount, with a
     *          period separating dollars and cents (eg, "120.50" for
     *          one hundred and twenty dollars and fifty cents)&lt;BR&gt;
     *          unless tickerSymbol is not a valid NYSE or NASDAQ
     *          symbol, when throws NoSuchTickerException&lt;br&gt; or
     *          unless an error connecting to the website or some
     *          other error occurs, when throws WebsiteDataException&lt;BR&gt;
     *          The amount returned may contain commas, for example,
     *          "2,243.87"&lt;br&gt;
     */
    public static String getLastValue(String tickerSymbol)
        throws WebsiteDataException, NoSuchTickerException {
        // the web page queried by the code below can be broken into tokens
        //   with delimiters being &lt;, &gt;, and =.  The token corresponding to
        //   the current stock price comes after the two tokens
        //   mw_simple_last and NOBR.
        String strURLStart = _URL;
        URL urlWebPage = null;
        InputStreamReader isr = null;
        BufferedReader brWebPage = null;
        
        // open the web page for reading
        try {
            urlWebPage = new URL(strURLStart + tickerSymbol);
            isr = new InputStreamReader(urlWebPage.openStream());
            brWebPage = new BufferedReader(isr);
        } catch(Exception e) {
            throw new WebsiteDataException();
        }
        
        // find the line with the stock quote on it
        String strLine = null;
        try {
            while(true) {
                strLine = brWebPage.readLine();
                if(strLine == null) {
                    throw new WebsiteDataException("Parse failed!");
                }
                if(strLine.indexOf(_TOKEN1) != -1)
                    break;
            }
        } catch(IOException e) {
            throw new WebsiteDataException();
        }
        
        // find the stock quote in the line
        StringTokenizer strtok = new StringTokenizer(strLine, _DELIMITER);
        while(true) {
            if(strtok.hasMoreTokens() == false)
                throw new NoSuchTickerException();
            if(strtok.nextToken().compareTo(_TOKEN1) == 0)
                break;
        }
        String strNOBR = strtok.nextToken();
        if(!strNOBR.equals(_TOKEN2))
            throw new NoSuchTickerException();
        String strStockValue = strtok.nextToken();

        //format check removed

        // close the web page stream
        try {
            brWebPage.close();
            isr.close();
        } catch(IOException e) {
            throw new WebsiteDataException();
        }
        
        return strStockValue;
    }
}
File NoSuchTickerException.java:

package folioTracker;

//    Class for the Ticker Exception

public class NoSuchTickerException extends Exception {
   NoSuchTickerException() {}
}
File WebsiteDataException.java:

package folioTracker;

//    Class for the Website Data Exception

public class WebsiteDataException extends Exception {
   WebsiteDataException() {}
   WebsiteDataException(String e) { super(e);}
}</pre></div></div><copyright><p class="copyright">Copyright &copy; 1998-2009 Dilvan Moreira</p></copyright><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="group_assignments_pacman.html"><img src="../../images/prev.gif" alt="Prev"></a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="group_assignments.html"><img src="../../images/up.gif" alt="Up"></a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="gui_awt.html"><img src="../../images/next.gif" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">6.&nbsp;PacMan&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="../../images/home.gif" alt="Home"></a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;23.&nbsp;Extra: Graphic User Interface - AWT</td></tr></table></div><script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
   </script><script type="text/javascript">
      try {
         var pageTracker = _gat._getTracker("UA-7961659-1");
         pageTracker._trackPageview();
      } catch(err) {}
   </script></body></html>